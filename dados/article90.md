Title: Scalable BIM based open workflow for structural analysis of masonry building aggregates

Abstract
Masonry building aggregates are complex historical structures comprising interconnected buildings. The safety of each building depends not only on its structural integrity but also on the interactions with neighbouring structures and their collective performance. The structural assessment of such complex constructions can benefit from BIM methodology. The latter eases modelling complicated solid geometries and assigning mechanical properties information essential for developing a reliable finite element model. Thus far, BIM to finite element analysis procedures applied to historic constructions have remained laborious, semi-automatic, and based on proprietary software. This paper introduces an open-source automated solid finite element analysis method using OpenBIM data (IFC). The tool implemented automatically creates tetrahedron mesh and assigns mechanical properties, self-weights, and fixities at the structure's base. The methodology is applied to an actual masonry building aggregate to validate its capability of working with complex geometries and scalability.
Previous article in issue
Next article in issue
Keywords
Built heritageHBIMFinite Element Method (FEM)Historic centresSeismic analysisOpenSeesInteroperabilityOpenBIM
1. Introduction
Masonry aggregates are unique historical unreinforced masonry structures that consist of assemblies of buildings, mainly residential, whose structural behavior is unitary. The presence of these constructions creates a recurring pattern within the landscape and significantly influences the morphology of historic centres [1], [2]. Although their cultural value is currently universally recognized, their state of preservation is often poor and somehow unsuitable for a contemporary lifestyle [3], [4].
A significant concern is the high vulnerability of masonry aggregates to natural hazards, particularly earthquakes [5]. After analysing post-seismic scenarios, the scientific community has delineated two distinct seismic mechanisms exhibited by unreinforced masonry buildings and by extension, masonry building aggregates: out-of-plane and in-plane. In out-of-plane mechanisms, portions of masonry walls (or entire walls) rotate perpendicularly to their plane, leading to the collapse of significant parts of the building. Conversely, in in-plane mechanisms, cracks are formed in the plane of walls. Out-of-plane mechanisms occur even during mild earthquakes, mainly when the structure exhibits deficient connections between adjacent walls or between walls and floors. On the contrary, in-plane mechanisms occur during stronger earthquakes and depend mainly on the masonry's shear resistance [1].
The current guidelines offer simplified methods to assess the seismic behaviour of masonry building aggregates, with a primary emphasis on out-of-plane ‘local’ failure, while neglecting their overall performance [6], [7]. In addition to the mechanisms typical of masonry buildings in general, aggregates introduce specific mechanisms, such as beatings of the floor of a building to the adjacent one. Based on these considerations, the existing guidelines facilitate the identification of vulnerable areas within the aggregate, enabling timely consolidation interventions in critical locations.
The most challenging aspect to achieve at present is the determination of the “aggregate effect,” which represents the variation in local responses arising from the composite nature of the construction. However, the proper assessment of this effect necessitates the utilization of global models [8]. The use of global models is considered as the most detailed level of analysis applicable for this type of construction, as defined in the guidelines, where it is stated that local analyses applied to small portions of the aggregate, without adequate modelling or with an approximate modelling of the interaction with adjacent building bodies, generally assume a conventional meaning and in some cases are even impracticable due to the uncertainty in the estimation of the variables to be adopted [7].
Structural engineering includes two ways of performing seismic analysis using global models: static and dynamic. Dynamic analyses enable a more representative simulation of the seismic behaviour of buildings, as they simulate the structure's dynamic response when a dynamic load is applied. Another option is to perform static analyses by applying horizontal loads simulating an earthquake and verifying the building's global capacity to withstand the horizontal load. The first procedure evaluates the building's dynamic response to a specific seismic load. In contrast, the second method estimates the overall structural capacity under horizontal loads [9], [10].
As per the Italian Building Code [11], which serves as a primary international reference for evaluating the structural behavior of unreinforced masonry structures, the utilization of global models is permissible only when there exists a satisfactory level of understanding regarding the assessed structure. This is because the reliability of global models strictly depends on the reliability of the input data [11]. For this reason, the structural model is the final step in a complex process involving experts from different fields. To identify the most appropriate modelling assumptions, historical analysis, in-situ surveys, inspections, and building monitoring must be carried out [12]. This process currently requires considerable time and economic resources. If this is already a major problem for individual buildings, it is even more so for complex structures such as masonry aggregates. For this reason, an optimal system for data and process management is required.
Aside from the need for deep knowledge of the building, when it comes to historical constructions, global analysis presents significant computational costs, mainly due to the material and geometrical nonlinearity of traditional masonry structures. Furthermore, a thorough knowledge of the building is necessary to obtain reliable results. In order to decrease the computational costs, simplified models have been defined, such as the equivalent frame method [13]. However, the use of solid finite element models is recognised as more representative of masonry's structural behaviour. Indeed, in the case of the equivalent frame, the structure is studied by considering pre-defined in-plane failure modes, neglecting possible out-of-plane collapses of the masonry. On the other hand, finite element analysis relies on the principles of continuum mechanics and mathematical modelling to simulate and understand the behaviour of structures under various conditions, and, even if not explicitly, it catches both in-plane and out-of-plane failure modes. Finally, masonry is a heterogeneous material consisting of units (bricks or stones) bound by joints (dry or with mortar) [14], [15]. This feature can be included in the structural model in two different ways. Either the units and joints are modelled explicitly (micro modelling), or homogenised mechanical parameters represent the unit-joints ensemble (macro modelling). Various studies have made it possible to obtain these parameters, and the mechanical characteristics of various types of masonry are present in the Italian standards [11], [16], [17].
In the literature, both static and dynamic analyses have been found applied to masonry aggregates. Most of the contributions are done using the equivalent frame method, and just a few employ the finite element analysis. Examples of equivalent frame modelling are found in [18], [19], [20], [21] and are intended to calibrate large-scale methods such as the 'vulnerability index'. The vulnerability index is still one of the most widely used methods for a fast large scale seismic assessment of masonry aggregates. Although it does not numerically evaluate the aggregate's behaviour to seismic excitations, it aids in identifying the most vulnerable units within a whole aggregate. References to this method are available in [22] and [23], as well as in [24], where potential integration into BIM/GIS methodologies is discussed.
In other contributions, equivalent frame models have been calibrated for analysing a single aggregate unit, creating boundary conditions that can represent the presence of adjacent units [25], [26]. However, these applications consider only simple one-line aggregates and neglect material nonlinearity. Finally, in [27], the equivalent frame is compared with solid finite element models. In this scenario, it is affirmed that finite element analyses prove more suitable since they can effectively account for both in-plane and out-of-plane mechanisms, rendering them more reliable. Moreover, the equivalent frame involves breaking down masonry into regular panels, aligning with the simulated failure modes. This task can become complex (or even impossible) in masonry aggregates due to geometric irregularities. Finally, another application of finite elements to masonry aggregates is found in [28], where an entire aggregate was modelled, even if only walls were modelled (neglecting the presence of the floors) due to modeling complexity and computational costs.
In the Architecture, Engineering and Construction (AEC) industry, the information management processes changed dramatically with the advent of Building Information Modeling (BIM). This methodology has been already applied to historical construction, referred to by the acronym of HBIM, which stands for Historic BIM [29]. Several HBIM uses have been proposed in the literature, validating the convenience of applying this method to historical construction [30], [31]. Applications of interest to this field include damage mapping [32], [33], health monitoring [34], and structural simulations [35], [36], [37]. In addition, the possibility of integrating energy analysis and different disciplines has been already stated [38], [39], as well as the possibility of establishing a connection between the HBIM model and additional information stored as different datatypes [40]. Integrating various aspects of rehabilitation, including energy efficiency and structural restoration, is crucial in historical constructions, given that masonry walls serve dual purposes as both structural elements and envelope components. Moreover, ongoing studies are dedicated to enhancing the modelling process itself through the integration of advanced surveying systems, notably laser scanning [41], [42].
Advanced acquisition systems offer the advantage of capturing complex geometry that can exert a significant influence on the structural response of historical buildings. As a result, workflows have been proposed to suitably derive the structural model from point cloud data [43], [44], [45], [46].
Conversely, other contributions use the capabilities of BIM to associate the modelled geometries with parameters, including those of mechanical properties. These frameworks propose using the point cloud to model the building in BIM and then transition to finite element models [35], [47], [37], or to use the initial point cloud to create two distinct models: a BIM model and a more simplified structural model, without direct interoperability between BIM and structural model [48], [36].
The primary challenge associated with the above-mentioned frameworks is their labour-intensive nature, as they are not fully automated processes, due to the absence of plug-ins to allow conversion from solid BIM representation to solid finite element meshing. These processes lack scalability and moreover rely on specific proprietary software. Consequently, those seeking to employ a particular methodology are required to obtain licenses, which can incur additional costs.
In contrast, vendor-neutral processes allow the benefits of BIM processes to be extended by making them more accessible. The current terminology for this approach is openBIM [49], which relies on the Industry Foundation Classes (IFC) [50] format as the basis for exchanging data in the openBIM framework. IFC is an open and neutral data format standard designed for the exchange and sharing of information within the building and infrastructure industries [51]. Extending the openBIM approach to historical constructions presents a relevant challenge since IFC has not been structured adequately to describe such building typology. The suggestion to incorporate additional classes into the IFC schema has been made to improve its compatibility with the structural analysis of historical buildings [52], [53]. Unfortunately, these classes are not currently acknowledged by either BIM or structural analysis software, rendering them unusable for this purpose.
This paper proposes an original openHBIM method for the global analysis of masonry aggregates, with the scope of facilitate the use of solid finite element modeling (with macro modeling of the material). In line with what has been said up to now, it is assumed that the integration of the HBIM methodology in the structural analysis of masonry aggregates can lead to better data management, integration with all phases of the structural analysis itself and with any other disciplines involved in the rehabilitation project.
The proposed approach involves employing a code developed by the authors to export the IFC model to the 'OpenSees' finite element calculation framework [54]. The code generates a mesh of tetrahedron elements and directly retrieves the mechanical properties from the parameters contained in the HBIM model. This methodology enables users to create their calculation models in any BIM software, export them to IFC, and conduct static and dynamic analyses. The model information is inputted into the BIM environment, adhering to the 'Level Of Information Need' specified by the authors [55]. Moreover, the OpenSees calculation framework is an open framework, ensuring the methodology's complete independence from proprietary software.
The finite element model underwent testing through gravity and eigenvalue analysis, using an aggregate with complex geometries as a case study. The model holds the potential for both static and dynamic nonlinear analyses, due to the model content and mesh refinement. However, nonlinear analysis would add extra complexity that would deviate from the main purpose of this paper, which is to present the developed algorithm in detail. Nevertheless, performing nonlinear analysis is definitely a next step of research for harvesting the true potential of this tool.
The article is organized as follows. Section 2 provides a comprehensive overview of the proposed methodology. Section 3 demonstrates the application of the methodology through a case study. Section 4 showcases the results obtained from the application. Section 5 presents the conclusions drawn from the study.
2. Scope and methodology
2.1. Masonry aggregates
Masonry aggregates are the traditional housing constructions in many European centres. These were raised using masonry made of local stone/brick for the vertical elements and timber slabs and roofs. These structures exhibit diverse plan and elevation configurations, influenced by factors like historical changes, site morphology, and construction periods. These configurations can range from irregular layouts that follow the terrain's morphology to more regular grid patterns. Various historical stages, such as the Middle Ages, Renaissance, Baroque, and 19th century, have contributed to the evolution of these aggregates. For example, Renaissance and Baroque periods saw the growth of aggregates with more regular plans, while the 19th century brought disruptive changes due to the creation of large roads [56], [57], [58]. Additionally, the introduction of new construction techniques like reinforced concrete led to the replacement of original roofs, introducing new vulnerabilities [1].
In contrast to monumental constructions, traditional residential buildings were not always built with the same level of attention to detail. This resulted in poor-quality wall cross-sections, especially in certain locations. Moreover, the successive construction phases introduced complexities in the configuration, including uneven floors, misaligned openings, and inadequate connections between cross walls. Structurally, these building compounds are particularly vulnerable to out-of-plane failure mechanisms, as the connections between orthogonal walls and between horizontal and vertical elements are not always adequate [59].
2.2. Proposed approach
The purpose of this contribution is to provide a systematic method for the comprehensive analysis of masonry aggregates. The integration with the HBIM methodology is included to increase the feasibility of a quick and cost-effective creation of complex models. Based on the construction characteristics of masonry aggregates, it is decided to employ solid FEM, bringing the potential of capturing other failure modes, aside from the prescribed ones. The accessibility of the methodology is guaranteed by proposing a methodology that does not rely on proprietary software. Aligned with an openBIM approach, it was decided to choose to use the IFC schema as our input model. In Section 3, the case study is modeled using Revit software (version 23.0.11.19) and then exported to IFC using the software's built-in IFC interpreter [60]. Any BIM modelling software can generate an IFC model based on the requirements outlined in this article (Section 2.3).
Interoperability between IFC and FEM was accomplished by developing a Python code, which was made available online for users and developers [61]. The proposed process starts from the BIM model and enables static and dynamic analysis in OpenSees. Due to the complexity of the geometry usually characterizing masonry aggregates, it is decided to use tetrahedra elements. The mechanical characteristics of the materials are associated with the elements directly in the BIM model and are read along with the geometry by the computational solver. Since OpenSees does not have an official open graphical interface, the results are displayed using the open FEM meshing software Gmsh [62], [63], [64].
Fig. 1 illustrates the overall workflow of the proposed methodology. By utilizing the Python code developed with its requisite dependencies, a seamless transition from an IFC model to the outcomes of the structural analysis can be achieved automatically. The 'IfcOpenShell' and 'OpenCascade' libraries enable access to the geometries and mechanical properties of the IFC model, respectively. The geometries undergo meshing using the Gmsh Python API, while the resulting mesh and mechanical properties are integrated into OpenSees for conducting the analyses. Finally, the analysis results are presented in the Gmsh GUI for visualization.

Download: Download high-res image (415KB)
Download: Download full-size image
Fig. 1. General workflow for the methodology. The workflow number refers to the detailed description of the algorithm in section 2.5.

2.3. Modelling requirements
The modeling requirements were established in accordance with the 'Level Of Information Need' schema outlined in EN17412-1. According to this standard, for each design stage, it is essential to define geometric requirements, alphanumerical information (non-graphical data associated with the geometry), and documentation, if applicable. Refer to [55] for a detailed description of this schema.
In the definition of the modelling requirements, BIM is leveraged as a collaborative platform for integrating diverse disciplines, enabling the creation of a federate multidisciplinary model from which generating multiple exports into IFC format tailored to specific disciplines. As can be seen from Fig. 2, the passage from an architectural model to a structural model consists of only exporting the structural elements and neglecting the non-structural ones. In this case, the use of solid FEM modelling allows for the creation of an analytical model that is more straightforward without needing adjustments when switching from solid to one- or two-dimensional elements. This approach will not hinder the use of the complete model for other purposes.

Download: Download high-res image (347KB)
Download: Download full-size image
Fig. 2. Federate multidisciplinary model compared to the discipline structural analysis model.

The objects of the structural breakdown were defined after a typological study based on the work of Giuffre [65], as follows: (1) structural wall, (2) partition, (3) foundation, (4) floor, (5) roof, and (6) openings (windows and doors). The following “IfcBuildingElement” are required to represent the different objects previously mentioned: “IfcWall” for Structural Walls and Partitions, “IfcFooting” for the foundations, “IfcBeam” for the main beams and secondary beams of roofs and floors, “IfcSlab” for the planking on top of the beams or reinforced concrete slabs, “IfcDoor” and “IfcWindow” for the openings. Each IFC object belongs to a specific “IfcBuildingElementType”. Fig. 3 shows common typologies of structural elements in masonry aggregates.

Download: Download high-res image (345KB)
Download: Download full-size image
Fig. 3. Common typologies of construction elements in masonry aggregates.

Coherently with the type of modelling chosen (macro modelling), it is not necessary to geometrically model units and mortar. Therefore, walls are to be modelled as continuous prisms, to which different mechanical property values are assigned, corresponding to different wall types. The floors, usually in timber, should be modelled as a set of rafters topped by a timber plank that redistributes the weights (as shown in Fig. 2), and if present, the main beam as shown in Fig. 3 (Type B). Similarly, for wooden roofs, modeling the joists is also critical. For one pitch roof, the direction of the joists can be the same of the slope (Fig. 2) or perpendicular to it (Fig. 3, Roof B1). More complex roofs are characterized by two layers of joists perpendicular to each other (Fig. 3, Roof B2), or by the presence of two pitches and one main beam (Fig. 3, Roof C). When present, it is fundamental to model concrete roofs, since those are often recent additions which often cause local mechanisms in the aggregate. As show in Fig. 3 (Roof D), these can be modelled as simple slabs. Vertical partition elements, while not having a main structural function, contribute to the overall behaviour of the structure. These can be brick walls as in Fig. 2 or timber post/lintel structures (Fig. 3, Partitions B). Doors and windows can present different variations, but only the difference between arches and lintels has been considered at this stage. Finally, information about the foundations is difficult to encounter, but foundations can be assumed as a downward continuation of the walls, with a thicker cross-section.
Regarding geometric requirements, 'Details' and 'Dimensionality' are established for each object, which are the relevant criteria for this application. All objects have 3D dimensionality, while the detail is established in Table 1. This is aligned with the choice of solid modeling and allows interoperability with different BIM uses.
Table 1. Detail of the elements in the breakdown.

Elements	Detail
Structural Wall	Continuous object of thickness equal to the resistant section of the masonry. The basic shape is a parallelepiped, which is modified by the presence of beams entering the wall thickness and stone lintels.
Opening	It consists of a void representing a hole in the wall and a solid representative of the lintel.
Foundations	Continuous object slightly thicker than the wall above.
Floor	Discontinuous object consisting of rectangular-section beams topped by two slabs representing respectively planking and tiling.
Roof	Discontinuous object consisting of rectangular-section beams topped by two slabs representing respectively planking and roof covering layer.
Partition	Continuous or discontinuous object (based on the type).
Regarding 'alphanumerical information,' this application requires mechanical characterization of structural materials and connection types between timber and walls. The following paragraphs, and Fig. 4 explain the IFC schema and how these properties are assigned to elements in the model.

Download: Download high-res image (278KB)
Download: Download full-size image
Fig. 4. Association of the material properties to the elements in IFC. The material properties define the IfcMaterial, which can be associated with an Element or an ElementType.

The IFC schema is structured hierarchically and organized into classes that define various entities. Within this schema, 'IfcBuildingElement' is a subclass of 'IfcObjectDefinition' and a superclass to entities such as IfcWall, IfcSlab, IfcRoof, IfcBeam, IfcFooting, IfcWindow, and IfcDoor — classes utilized by the authors to model structural elements. On the other hand, 'IfcMaterial' is a subclass of 'IfcMaterialDefinition', and it is employed, in this application, for modelling structural materials.
Mechanical properties of materials and pertinent characteristics of structural elements, like wall-timber connections, are represented as 'IfcProperties,' a subclass of 'IfcPropertyDefinition.' These properties are organized into groups called 'IfcPropertySets,' another subclass of 'IfcPropertyDefinition.' Each 'IfcProperty' is associated with an 'IfcBuildingElement' or an 'IfcMaterial' via the class 'IfcRelDefinesByProperty,' a subclass of 'IfcRelationship.' Specifically, mechanical properties are 'IfcProperties' associated with their respective 'IfcMaterial'. The type of wall-to-beam connections, on the other hand, is modelled with a parameter that is associated with the beams.
The IFC schema inherently offers various 'IfcPropertySets' containing 'IfcProperties' for diverse applications. In this context, two 'IfcPropertySets'—'IfcMaterialCommon' and 'IfcMaterialMechanical'—contain specific mechanical properties. 'IfcMaterialCommon' includes the property 'MassDensity,' while 'IfcMaterialMechanical' encompasses 'YoungModulus,' 'ShearModulus,' and 'PoissonRatio.' In Finite Element Method (FEM) modelling, 'ShearModulus' and 'PoissonRatio' are often correlated. The BIM modeller can choose either, depending on available data, such as in situ tests on masonry.
When modelling features beyond the basic IFC schema, one can introduce new 'IfcPropertySets' with customized 'IfcProperties.' For instance, for the scope of the project, the authors introduced 'Pset_MaterialHistoricMasonry,' accommodating parameters outlined in the NTC [11] not covered by the IfcPropertySets. Similarly, a new 'IfcPropertySet' called 'IfcConnection' was defined for structural information, describing connections between walls and beams. Within this property set, the 'Connection' property can assume values like 'null,' 'unstrengthen,' or 'perfect.' Based on this property associated with beams, the decision to export the beam is determined respectively, if the connection is 'null' or 'perfect.' For intermediate situations (unstrengthen), efforts are underway to automate, in this IFC to FEA framework, the implementation of nonlinear springs associated with this non-perfect connection (see [66] for detailed information).
Finally, the association of an 'IfcBuildingElement' with an 'IfcMaterial' can occur in two distinct ways: through 'IfcBuildingElementType' or directly through 'IfcBuildingElement' itself. The former is applicable when identical walls, for example, are modelled using a wall type ('IfcBuildingElementType') to which various instances ('IfcBuildingElement') are linked. In the latter case, a unique wall with a specific material not belonging to any 'IfcBuildingElementType' is represented. In both scenarios, the 'IfcMaterial' is associated with either the 'IfcBuildingElement' or the 'IfcBuildingElementType' through the relation 'IfcRelAssociatedMaterial,' a subclass of 'IfcRelationship.' Moreover, depending on the object type, the material is associated with the object in either 'layers' or 'profiles.' For instance, a wall may have several layers with different materials, while a beam may feature one or more resistant sections.
In addition to defining modeling requirements, exchange requirements are also established to determine the most suitable Model View Definition. Currently, there are two options available: 'Reference View' and 'Design Transfer View.' The former is mainly intended to validate the model's accuracy, particularly for identifying and resolving geometrical conflicts between the elements (known as clash detection). Conversely, the latter is specifically designed for sharing useful data across different domains (for example: sharing the geometry from the architectural to the structural model). This holds significant importance, as the selection of one Model View Definition over another influences the way geometries are depicted within the IFC format.
All structural elements are represented in 3D. In IFC, the 'IfcShapeRepresentation' class attributes a geometry representation to an 'IfcBuildingElement', and it is inherited from 'IfcProduct'. The IFC standard presents a range of Representation Types, and not all of them are adequate for the scope of this research. For instance, a solid can be represented through tessellation, but this representation only creates the illusion of a solid, as it is just a surface. On the contrary, actual solids representations are the following:
(1)
SweptSolid. It is created by moving a two-dimensional shape, known as a profile, along a specified path in space. Tapered sweeps are referred to as AdvancedSweptSolid.
(2)
CSG (Constructive Solid Geometry). A solid is created from a Boolean operation between primitive solids.
(3)
Clipping. A solid is created by removing portions of an initial solid from a clipping region.
(4)
BRep. A solid is created as a collection of faces, edges, and vertices, which are used to define the boundaries and topology of the object.
(5)
Advanced BRep. A BRep supporting NURBS.
In the context of masonry aggregates, exporting a model using the 'Reference View' reveals that the complex geometries lead to the creation of a Tessellation. Conversely, the 'Design Transfer' approach offers a broader range of options and ensures the export of solid geometry (Fig. 5). This observation provides additional justification for designating the Design Transfer View as a necessary exchange requirement.

Download: Download high-res image (201KB)
Download: Download full-size image
Fig. 5. Types of representation used for masonry aggregate walls available in different MVD.

2.4. Developed algorithm
The interoperability framework has been developed leveraging the capabilities of the following libraries: (a) IfcOpenShell (IfcOpenShell [67], (b) PythonOCC [68], (c) Gmsh [64], (d) Gmsh2OpenSees [63], and (e) OpenSeesPy [69]. Fig. 6 to Fig. 10 show the details of the code and can be traced back to the generic workflow in Fig. 1.

Download: Download high-res image (546KB)
Download: Download full-size image
Fig. 6. Algorithm retrieving alphanumerical information.

The first algorithm can be divided into three parts, indicated on the left side of Fig. 6: 1) Input; 2) Material collection; 3) Material data collection.
(1)
The ‘Input’ consists of a for loop which retrieves all the IfcElements (beams, floors, walls, opening, and slabs) present in the IFC model (Fig. 6- a).
(2)
The ‘Material collection’ consists of retrieving the material linked to the element collected. If the material is associated with the element (instance), it is directly linked through a “Relating material” (Fig. 6 – c). Alternatively, if the material is associated with the element type, the element is linked through a different association: the Relating type (Fig. 6 - b). The developed algorithm can obtain the “Relating material” in both cases. An element or element type can have many ‘Relating material’ to different ‘IfcMaterial’. In particular, based on the construction element, a ‘relating material’ can be either a ‘material layer set’ or a ‘material profile set’ (see also Fig. 4). For example, in the case of a wall, it can be composed of one or many material layers. Conversely, a beam can have one or more material profiles. The developed algorithm investigates whether the material is stored in layers or profiles. Based on this, it retrieves the relevant IfcClasses: IfcMaterialLayer (Fig. 6 – d) or IfcMaterialProfile (Fig. 6 – e). Finaly, collects the corresponding IfcMaterial.
(3)
The ‘Material data Collection’ retrieves the mechanical properties associated to the materials and stores them into a Python ‘dictionary’. A dictionary in Python is a collection of key-value pairs, allowing efficient retrieval and storage of data. In this dictionary, the first key is the name of the material, which is an attribute of the class ‘IfcMaterial’ (Fig. 6 – f). As shown in Fig. 4, each mechanical property needed for the analysis shall be stored in IFC as a ‘Property’ in a ‘Property Set’. The algorithm uses a for loop to access each property in the correspondent Property Set (Fig. 6 – g) and extract the name and the value of the property, which saves them as 'key' and 'value' in the dictionary, respectively.
The ‘Output’ of this algorithm consists essentially of this python dictionary. As seen in the example (Fig. 6 – l), for each object (a structural material) there are several properties (MaterialName, YoungModulus, PoissonRation, MassDensity) to which it is associated a value (Masonry4, 400, 0.2, 2100).
The second algorithm (Fig. 8) converts the IFC file to a STEP file, allowing interoperability between IFC and the meshing generator. Even though the IFC to STEP conversion process can be automated through the utilization of the Python module 'IfcConvert' (IfcOpenShell [67], a tailored function was developed to keep track of the materials associated with the shapes, preserving the alphanumeric information from the passage from the IFC to the STEP file.
The second algorithm is organized in two parts, as follows: 1) Input, 2) Create Manifold Solid BRep.
(1)
The input collects all IfcElements and with a ‘for’ loop (Fig. 8 – a) for each individual IfcElement their object type names (Relating type) (Fig. 8 – b) are compared with each material name in the previously generated dictionary (Fig. 8 – c). If the object type name contains a material name, it is assigned as a variable in Python, referred to as ‘label’.
(2)
In part 2 of the algorithm, the geometry of each IFC element is obtained in B-Rep format, using the 'Open Cascade' geometry kernel (Fig. 8 – d). To carry out a solid analysis, volumes must be as ‘TopoDS Solid’, converted in STEP as ‘manifold solid B-Rep’. It has been noted that when complex solids are modelled in IFC as IfcAdvancedBRep, this causes them to break into individual faces during STEP conversion. In that case, the shape is represented as a compound of faces (named TopoDS Compound). To guarantee preserving a solid representation of the objects, the developed algorithm checks when this happens, and generates the solid from the envelope of compound faces (Fig. 8 – e). This conversion process consists of three steps (Fig. 7): identification of children entities, sewing and solid generation. The first step is identifying the geometric entities which are in the TopoDS Compound, which are recognized by Open Cascade as the ‘children’ of the TopoDS Compound. Then, these shapes are joined together using the sewing function, in such a way that Open Cascade kernel recognizes them as a unique coherent shape. Finally, from this shape is generated a solid, of which the sewed shape is the envelope.

Download: Download high-res image (161KB)
Download: Download full-size image
Fig. 7. Conversion of compound of faces into a solid.


Download: Download high-res image (508KB)
Download: Download full-size image
Fig. 8. STEP conversion.

The solids are associated to the ‘label’ generated in the initial phase of the algorithm, ensuring the preservation of material-related geometry (Fig. 8 – f).
Finally, this solid geometry is stored in a STEP file, maintaining the label information associated with the geometry (Fig. 8 – g).
The third algorithm (Fig. 9) is structured into four parts: 1) Input, 2) Physical Groups, and 3) Boundary Conditions.
(1)
In the ‘Input’, the STEP file is imported in Gmsh, using the Gmsh Python API, and it is used to generate a Gmsh geometry file (Fig. 9 – a). The solid shapes imported into Gmsh retain the STEP file labels, as ‘Entity name’ and are additionally associated with an incrementing number known as the ‘Entity tag’, acting as a unique identifier for each shape.
(2)
In the second part of the algorithm, a for loop iterates the data from the python dictionary (Fig. 10 – b) to subsequently obtain the material name (Fig. 9 – b). The ‘Entity name’ and ‘Entity tag’ of the figure are retrieved. The ‘Entity name’ of each shape is compared with each material name retrieved from the dictionary. This allows to cluster the Gmsh geometries in groups (called ‘Physical Groups’), based on their material (Fig. 9 – e). The ‘Physical Groups’ are created by defining the name of the group equal to the name of the material and introducing the relevant shapes using their ‘Entity Tag’ (Fig. 9 – d).
(3)
Then, the third part of the algorithm assigns boundary conditions. Specifically, default foundation elements are designated as having a material called Masonry Footing. Therefore, in this phase, the code extracts all solids in Gmsh belonging to the physical group which contain the word 'footing' (Fig. 9 - f) and retrieves the bottom surfaces (Fig. 9 – g). These surfaces are assigned to a specific group named 'Fix’ (Fig. 9 – h).

Download: Download high-res image (596KB)
Download: Download full-size image
Fig. 9. Meshing algorithm.


Download: Download high-res image (553KB)
Download: Download full-size image
Fig. 10. Analysis.

After updating the model with the new geometry (synchronization), the mesh, which is the output of this algorithm, is generated (Fig. 9 – i).
The fourth algorithm is structured into four parts: 1) Input, 2) OpenSees Model, and 3) Analysis.
(1)
In the input, the mesh from the Gmsh model (Fig. 10 – a) and the Material Dictionary (Fig. 10 – b) are retrieved.
(2)
Subsequently, the tetrahedron elements from the Gmsh model are employed to generate nodal coordinates and elements. To generate the nodes, the function 'add nodes to OpenSees' is used (Fig. 10 – c). To create the elements, it is necessary to associate the Gmsh tetrahedron with the corresponding material. Materials in OpenSees are introduced using data extracted from the material dictionary (Fig. 10 – d).
Finally, the algorithm associates the tetrahedrons with the material, based on the name of the physical group to which they belong (Fig. 10 – e). Therefore, OpenSees elements are generated (Fig. 10 – f). Afterwards, elements within the 'Fix' Physical Group undergo fixation in all three translational directions (Fig. 10 – g).
(3)
In the third part of the algorithm, the analyses are set using OpenSeesPy functions to define static analysis, eigenvalue analysis (as demonstrated in our practical application in chapter 3), and any other specific analyses desired (such us Pushover or Time History) (Fig. 10 – i).
The output consists of the results of the analysis, displayed in Gmsh. (Fig. 10 – l).
To check coherency with units in the IFC-Gmsh-OpenSees conversion it was done a quick analysis of a simple wall. A 4-by-4-meter wall with a thickness of 40 cm, was modelled using the Revit software, and exported to the IFC format, following the requirements established previously. Then, the developed code has been used to evaluate the displacement associated with the self-weight analysis. In parallel, a manual modelling approach was adopted using Diana FEA, and under identical conditions and settings, the same numerical analysis was performed and the results obtained from the two approaches were found to be consistent. Finally, the practical application in a complex study case proves that the framework proposed works for complex geometries.
3. Practical application
As part of developing a methodology for assessing masonry aggregates, special attention was given to the application in a meaningful study case, to prove the potential of the framework. The application was done to an aggregate of the historic centre of Ortigia (Siracusa, Italy). The existing extensive historical and graphic documentation, due to Giuffre's research and previous restoration projects in the Graziella quarter, facilitated the collection of information and made it possible for the authors to focus primarily on workflow development [65]. Comprehensive visual records of the historic centre of Ortigia, including detailed documentation, can be accessed, and searched on the official website of the Municipality of Syracuse.
3.1. Modelling
The masonry aggregate chosen for the practical application is one the city block ‘47′ and its documentation can be found in table E27 on the Syracuse municipal website. The existing documentation includes plans and elevations, rendered at a scale of 1:200, providing valuable insights into the chosen aggregate’s architectural characteristics. To determine the typologies and features of the structural elements, a combination of methods was employed. This involved cross-referencing graphical information with Giuffré’s typology survey, as well as utilizing data obtained through visual inspections and satellite imagery. The aim is not to replicate the exact details of the original construction, but rather to demonstrate the potential application of the proposed methodology.
The building was modelled on Autodesk Revit (version 23.0.11.19), as it is one of the most widely used BIM modelling software. However, the utilization of this specific modelling software is not mandatory for those interested in employing the framework, as it is sufficient to export to IFC (accessible from the GitHub code as an example) complying with the requirements defined in the previous chapter. Fig. 11 shows the geometry of the BIM model of the aggregate. The longest side of the aggregate attains a considerable dimension of approximately 33 m. The composite entity encompasses a total of 12 constituent building units, of which 6 have flat rooftops. This characteristic is attributable to erroneous intervention practices that were employed during the 20th century. Within the model, these flat roofs have been modelled as concrete slabs, while the pitched roofs adhere to the typological frameworks expounded upon in the antecedent chapter. Additionally, the aggregate integrates 4 superimposed structures, which bear testament to their localized vulnerability. The axonometric cross-section unveils a comprehensive portrayal of the meticulously modelled interiors, encompassing beams, planking, and partition walls with timber lintels and posts.

Download: Download high-res image (441KB)
Download: Download full-size image
Fig. 11. Three-dimensional representation of the aggregate. South, north, and axonometric views with sections to identify the representation detail obtained.

To provide insight into the material properties, the table present in the Italian Building Code is utilized for information pertaining to masonry, while Giuffre's contribution serves as a reference for other elements [65], [11]. The masonry elements predominantly employ soft stone, which exhibits either regular or irregular patterns. On the other hand, more recent partitions are predominantly constructed using regular masonry with brick units. A comprehensive summary of the material characteristics can be found in Table 2. The parameters have been associated with the Revit material of the related elements. Types of masonry are called 'StructuralMasonry' followed by a number that corresponds to the position of this type of masonry in the NTC table.
Table 2. Material properties. Sources: a) [65], b) [70], c) [71].

Empty Cell	Material in IFC	Mass Density (kg/m3)	Young Modulus (MPa)
Irregular soft stone masonry	StructuralMasonry4	1400	900
Regular soft stone masonry	StructuralMasonry5	1200	1200
Solid brick and lime mortar	StructuralMasonry6	2200	2400
Timber sections	StructuralTimber	600[a]	10,000[b]
Timber board	TimberBoard	600	1000
Limestone	Stone	2600[c]	20,000[c]
With regard to the connections between beams and masonry, for this practical application, it was decided to connect the beams totally to the wall, both for lack of data and in order to be able to focus on the general framework in this contribution.
Once the model is finished, it is exported to IFC4 Design Transfer View, associating the Revit material parameters in the correct IFC Property Sets. Subsequently, the implementation of strict clash detection safeguards against any potential absence of Boolean operations, specifically among the beams and walls. This has been done using the software BIMCollabZoom, setting a clash tolerance of 0.005 m3. All identified clashes are then exported in the BIM Collaboration Format (BCF), allowing for easy re-importation into the authoring software to rectify any error.
3.2. Algorithm application
The IFC model is saved in the folder of the developed code. The folder is opened with ‘Visual Studio Code’ software, and the IFC2OpsEnvironment is set as Python interpreter, to access the required dependencies. The file ‘Code.py’ is opened, which is the base file, calling the various functions, for the user to launch the analysis, by loading the structural model in the folder of the code, and ensuring that name of the file corresponds to the one defined in the function for opening it. The file ‘Code.py’ calls all the function developed, providing automatic meshing, analysis and showing the results. At this stage, a Physical Group with the upper floor surfaces is manually added in Gmsh, so that live loads can be added using the 'load' function in OpenSeesPy.
Not all elements have a mesh of this size, as it refines at the most critical points (higher expected strain gradients). More refined meshes have also been tried, and the mesh is correctly created and exported to OpenSees. However, complex memory problems are generated in the conclusion of the analysis because parallelization of the code has not been applied in this application. A mesh refinement is deferred to a future application, as it involves a different application, involving coding parallelization.
After generating, the mesh (33,527 elements) is automatically opened in Gmsh, allowing for the observation of the precise formation of physical groups for materials and boundary conditions. Additionally, there is the option to customize these settings, including the choice to refrain from automatically opening the mesh, to save time, if required. Gmsh follows a process of first creating one-dimensional elements, followed by two-dimensional elements, and finally three-dimensional elements. Only the three-dimensional elements are exported to OpenSees. The complete three-dimensional mesh is depicted in Fig. 12, with different colours indicating distinct physical groups. In the zoomed-in sections, the mesh demonstrates successful refinement, where more sophisticated geometries are present.

Download: Download high-res image (911KB)
Download: Download full-size image
Fig. 12. Final mesh used for the analysis. Different colours represent different Physical Groups (materials).

Considering mesh detail and information content, this model can be used to perform nonlinear static and dynamic analyses. However, nonlinear analyses will be deferred to a future contribution due to the need for additional in-depth discussions.
3.3. Results
The eigenvalue analysis was conducted to determine the vibration modes of the structure, enabling a rapid evaluation of its dynamic characteristics. The first 300 modes were considered, ensuring that the cumulative effective modal mass in the X and Y directions accounted for at least 90 %. The necessity of considering such a big number of modes is due to the presence of several local modes. Local modes mainly concur at the highest points of the structure, where the compound effect is the least. This occurs mainly in corners and in proximity to staggered floors, but also on the volumes more recently added. Fig. 13 illustrates the distribution of the initial 300 modes. Notably, the modes exhibiting lower frequencies correspond to those involving larger masses. Specifically, mode 4 demonstrates the highest mass involvement in the Y direction, whereas mode 2 holds this distinction in the X direction. Beyond mode 15, the modes with higher frequencies predominantly exhibit localized behaviour. Furthermore, the angular components, especially mode 4, appear to be the most susceptible to vulnerability. Additionally, it is worth mentioning that the pitched shape of the walls exerts a significant influence, rendering them more susceptible to damage.

Download: Download high-res image (380KB)
Download: Download full-size image
Fig. 13. Distribution of the X and Y vibration modes.

Afterwards, the static analysis was conducted by applying linearly the self-weight of the structural elements, and the displacements were evaluated. Fig. 14 reports the most apparent displacements observed in the north axonometric view. This is particularly noticeable in the elongated elevation where the three central units have greater height, as well as in the shorter elevation featuring a pitched wall. Additionally, the presence of openings near the corners contributes to significant displacements. Finally, the largest displacements were found in two of the four small volumetric additions on the roofs, mainly the one with the most openings. On the other hand, in the longest elevation of the “South View”, where there are fewer openings and a more compact geometry, the displacements are comparatively less pronounced.

Download: Download high-res image (681KB)
Download: Download full-size image
Fig. 14. Results of self-weight static analysis. The largest displacements are shown in red.

Stresses distributions in the directions σxx, σyy, σzz, σxy σyz and σxz were computed. In the two principal horizontal directions (σxx and σyy), higher concentrations of compression stresses are observed in the horizontal wall portions between the openings, commonly known as ‘piers’; tension concentrations are found in the proximity of staggered floors. Finally, in the direction σxy the most relevant concentration of stresses are tension concentrations on horizontal elements. In the principal vertical direction (σzz), compression stresses are more prominent in the corners, especially in the bottom part of the building (Fig. 15). Tension concentrations are present in beams and in the vertical portions between the openings, known as spandrels. In the directions σyz and σxz a combination of tension and compression stresses is found on top of the openings. Since linear analysis was conducted, the same pattern distribution was found in terms of strains.

Download: Download high-res image (613KB)
Download: Download full-size image
Fig. 15. Stress distribution in σzz direction.

4. Conclusions
The application of global numerical analysis in the structural identification of masonry aggregates remains a major challenge. To address this problem, a novel approach based on the integration of BIM and FEM is presented and framed by a scalable and open framework. This paper provided three primary results: (1) the Level of Information Need for structural analysis of masonry aggregates; (2) the automated implementation of solid finite element models from IFC models; (3) the results of static and dynamic analysis of an entire aggregate without neglecting beams and floor elements.
The definition of the Level of Information Need is a contribution in the field of standardisation of information management for the digitisation of built heritage processes. This was propaedeutic for the development of the algorithm for BIM to FEM interoperability, as there were standardised inputs to make the algorithm reproducible. The choice of continuum finite element analysis as a modelling strategy shortened the distance between BIM model and structural model. In accordance with the defined modelling requirements, the person involved in the structural analysis only had to philtre out the elements relevant for the simulation and export the IFC according to the defined modelling and export criteria. In this way, it became possible to create a model that is useful for different disciplines.
In developing the algorithm, the main challenge was to create a scalable framework that could be applied to different case studies. Two main aspects were considered: (1) maintaining the link between the shapes and the alphanumeric information; (2) exporting the shapes of the elements always as solids. This was made possible using open Python libraries. Dictionaries were used to store alphanumeric data efficiently, and the OpenCascade geometric kernel ensured the solidity of the shapes. Although the last point may seem trivial, it is not. After all, the more complex the geometries, the greater the risk that they will be calculated as a series of surfaces instead of a single body. One of the results of the algorithm developed is to recognise the type of representation and ensure that each shape is solid.
The algorithm is easy to use and adapt by defining a virtual environment that is shared. The exclusive use of open-source libraries also frees the algorithm from all the constraints associated with proprietary software and eliminates the need for licences. Even though the primary goal was to develop a novel approach to the evaluation of masonry aggregates, the potential of the resulting framework goes far beyond that. Thanks to its scalability, it can be applied to different types of structures, which greatly expands its potential applications.
The model presented in the case study was used to perform linear analysis, demonstrating the ability of the developed algorithm to use the data in the BIM model to create a fully functional finite element model, and scalable to complex geometries. This is a new step in BIM to FEM interoperability, as until now these processes were semi-automatic, laborious and associated with specific software, and therefore not open. From a structural analysis point of view, the biggest achievement was that we were able to observe the results of static and dynamic analyses of an entire aggregate, modelling not only the masonry but also the other structural elements, all while maintaining three-dimensional modelling. This involves a step forward in the literature, as until now modelling other elements (besides masonry) usually is done using simplified strategies based on predetermined modes of failure.
Subsequent progress of this work will consist of using this method to perform nonlinear analyses to fully exploit the developed tool's potential. This is already possible due to the presence of a refined mesh and the necessary material parameters. However, this application requires a dedicated article due to the need for a detailed description of all the specific aspects involved on it.
Finally, future developments of this work include: (1) to automatise the modeling of unstrengthen connections; (2) to simplify the application of live loads and external excitations directly from the BIM model; (3) to make it possible to set the mesh size in the BIM model.